import sqlite3

# Database setup
DATABASE = 'team.db'

def add_team_to_db(team_name):
    """Ensure the team exists in the database."""
    conn = sqlite3.connect(DATABASE)
    cursor = conn.cursor()
    cursor.execute("INSERT OR IGNORE INTO teams (name) VALUES (?)", (team_name,))
    conn.commit()
    cursor.execute("SELECT id FROM teams WHERE name = ?", (team_name,))
    team_id = cursor.fetchone()[0]
    conn.close()
    return team_id

def add_player_to_db(name, jersey_number, team_name, image_path="uploads/default_player.jpg"):
    """Add a player to the database."""
    conn = sqlite3.connect(DATABASE)
    cursor = conn.cursor()
    
    # Ensure team exists and get its ID
    team_id = add_team_to_db(team_name)
    
    # Split the name into first and surname
    name_parts = name.split(" ", 1)
    first_name = name_parts[0]
    surname = name_parts[1] if len(name_parts) > 1 else ""

    # Insert player
    cursor.execute(
        "INSERT INTO players (name, surname, jersey_number, team_id, image_path) VALUES (?, ?, ?, ?, ?)",
        (first_name, surname, jersey_number, team_id, image_path)
    )
    conn.commit()
    conn.close()
    print(f"Added player: {name} (#{jersey_number}) to {team_name}.")

def add_players_from_list(players, team_name):
    """Add a list of players to the database."""
    for player in players:
        name = player["name"]
        jersey_number = player["shirtNumber"]
        add_player_to_db(name, jersey_number, team_name)

# Player data
teams_and_players = {
    "Beşiktaş": [{"id":337800,"name":"Gedson Fernandes","shirtNumber":"83","positionId":3,"link":"/gedson-fernandes/profil/spieler/337800"},{"id":875334,"name":"Semih Kılıçsoy","shirtNumber":"9","positionId":4,"link":"/semih-kilicsoy/profil/spieler/875334"},{"id":238055,"name":"Rafa","shirtNumber":"27","positionId":4,"link":"/rafa/profil/spieler/238055"},{"id":377641,"name":"Moatasem Al-Musrati","shirtNumber":"6","positionId":3,"link":"/moatasem-al-musrati/profil/spieler/377641"},{"id":583917,"name":"Ernest Muci","shirtNumber":"23","positionId":4,"link":"/ernest-muci/profil/spieler/583917"},{"id":278343,"name":"Felix Uduokhai","shirtNumber":"14","positionId":2,"link":"/felix-uduokhai/profil/spieler/278343"},{"id":291739,"name":"Milot Rashica","shirtNumber":"7","positionId":4,"link":"/milot-rashica/profil/spieler/291739"},{"id":531332,"name":"Emirhan Topçu","shirtNumber":"53","positionId":2,"link":"/emirhan-topcu/profil/spieler/531332"},{"id":181380,"name":"Arthur Masuaku","shirtNumber":"26","positionId":2,"link":"/arthur-masuaku/profil/spieler/181380"},{"id":344299,"name":"Bakhtiyor Zaynutdinov","shirtNumber":"22","positionId":3,"link":"/bakhtiyor-zaynutdinov/profil/spieler/344299"},{"id":651005,"name":"Cher Ndour","shirtNumber":"73","positionId":3,"link":"/cher-ndour/profil/spieler/651005"},{"id":105521,"name":"Ciro Immobile","shirtNumber":"17","positionId":4,"link":"/ciro-immobile/profil/spieler/105521"},{"id":149729,"name":"João Mário","shirtNumber":"18","positionId":3,"link":"/joao-mario/profil/spieler/149729"},{"id":656441,"name":"Jean Onana","shirtNumber":"71","positionId":3,"link":"/jean-onana/profil/spieler/656441"},{"id":170838,"name":"Salih Uçan","shirtNumber":"8","positionId":3,"link":"/salih-ucan/profil/spieler/170838"},{"id":143424,"name":"Alex Oxlade-Chamberlain","shirtNumber":"15","positionId":3,"link":"/alex-oxlade-chamberlain/profil/spieler/143424"},{"id":462772,"name":"Tayyip Talha Sanuç","shirtNumber":"5","positionId":2,"link":"/tayyip-talha-sanuc/profil/spieler/462772"},{"id":451642,"name":"Can Keleş","shirtNumber":"77","positionId":4,"link":"/can-keles/profil/spieler/451642"},{"id":149498,"name":"Gabriel Paulista","shirtNumber":"3","positionId":2,"link":"/gabriel-paulista/profil/spieler/149498"},{"id":500091,"name":"Ersin Destanoğlu","shirtNumber":"30","positionId":1,"link":"/ersin-destanoglu/profil/spieler/500091"},{"id":1071252,"name":"Mustafa Hekimoğlu","shirtNumber":"91","positionId":4,"link":"/mustafa-hekimoglu/profil/spieler/1071252"},{"id":136184,"name":"Jonas Svensson","shirtNumber":"2","positionId":2,"link":"/jonas-svensson/profil/spieler/136184"},{"id":152733,"name":"Onur Bulut","shirtNumber":"4","positionId":2,"link":"/onur-bulut/profil/spieler/152733"},{"id":51894,"name":"Mert Günok","shirtNumber":"34","positionId":1,"link":"/mert-gunok/profil/spieler/51894"},{"id":77710,"name":"Necip Uysal","shirtNumber":"20","positionId":2,"link":"/necip-uysal/profil/spieler/77710"},{"id":873445,"name":"Emrecan Terzi","shirtNumber":"79","positionId":2,"link":"/emrecan-terzi/profil/spieler/873445"},{"id":935552,"name":"Emir Yaşar","shirtNumber":"96","positionId":1,"link":"/emir-yasar/profil/spieler/935552"},{"id":983817,"name":"Fahri Ay","shirtNumber":"44","positionId":3,"link":"/fahri-ay/profil/spieler/983817"},{"id":935550,"name":"Arda Kılıç","shirtNumber":"19","positionId":4,"link":"/arda-kilic/profil/spieler/935550"},{"id":875333,"name":"Göktuğ Baytekin","shirtNumber":"94","positionId":1,"link":"/goktug-baytekin/profil/spieler/875333"},{"id":1047550,"name":"Arda Berk Özüarap","shirtNumber":"93","positionId":2,"link":"/arda-berk-ozuarap/profil/spieler/1047550"}],
    "Fenerbahçe": [{"id":287579,"name":"Sofyan Amrabat","shirtNumber":"34","positionId":3,"link":"/sofyan-amrabat/profil/spieler/287579"},{"id":433049,"name":"Youssef En-Nesyri","shirtNumber":"19","positionId":4,"link":"/youssef-en-nesyri/profil/spieler/433049"},{"id":320748,"name":"Sebastian Szymański","shirtNumber":"53","positionId":3,"link":"/sebastian-szymanski/profil/spieler/320748"},{"id":272642,"name":"Allan Saint-Maximin","shirtNumber":"97","positionId":4,"link":"/allan-saint-maximin/profil/spieler/272642"},{"id":191614,"name":"Fred","shirtNumber":"13","positionId":3,"link":"/fred/profil/spieler/191614"},{"id":591361,"name":"Jayden Oosterwolde","shirtNumber":"24","positionId":2,"link":"/jayden-oosterwolde/profil/spieler/591361"},{"id":613725,"name":"İsmail Yüksek","shirtNumber":"5","positionId":3,"link":"/ismail-yuksek/profil/spieler/613725"},{"id":205927,"name":"Dominik Livakovic","shirtNumber":"40","positionId":1,"link":"/dominik-livakovic/profil/spieler/205927"},{"id":216603,"name":"İrfan Can Kahveci","shirtNumber":"17","positionId":4,"link":"/irfan-can-kahveci/profil/spieler/216603"},{"id":341647,"name":"Cengiz Ünder","shirtNumber":"20","positionId":4,"link":"/cengiz-under/profil/spieler/341647"},{"id":250844,"name":"Alexander Djiku","shirtNumber":"6","positionId":2,"link":"/alexander-djiku/profil/spieler/250844"},{"id":320141,"name":"Çağlar Söyüncü","shirtNumber":"4","positionId":2,"link":"/caglar-soyuncu/profil/spieler/320141"},{"id":358948,"name":"Bright Osayi-Samuel","shirtNumber":"21","positionId":2,"link":"/bright-osayi-samuel/profil/spieler/358948"},{"id":410158,"name":"Rodrigo Becão","shirtNumber":"50","positionId":2,"link":"/rodrigo-becao/profil/spieler/410158"},{"id":353922,"name":"Mert Müldür","shirtNumber":"16","positionId":2,"link":"/mert-muldur/profil/spieler/353922"},{"id":161011,"name":"Filip Kostić","shirtNumber":"18","positionId":2,"link":"/filip-kostic/profil/spieler/161011"},{"id":563749,"name":"Oğuz Aydın","shirtNumber":"70","positionId":4,"link":"/oguz-aydin/profil/spieler/563749"},{"id":36139,"name":"Dusan Tadic","shirtNumber":"10","positionId":4,"link":"/dusan-tadic/profil/spieler/36139"},{"id":388820,"name":"Levent Mercan","shirtNumber":"22","positionId":2,"link":"/levent-mercan/profil/spieler/388820"},{"id":28396,"name":"Edin Dzeko","shirtNumber":"9","positionId":4,"link":"/edin-dzeko/profil/spieler/28396"},{"id":295024,"name":"Samet Akaydin","shirtNumber":"3","positionId":2,"link":"/samet-akaydin/profil/spieler/295024"},{"id":45671,"name":"Cenk Tosun","shirtNumber":"23","positionId":4,"link":"/cenk-tosun/profil/spieler/45671"},{"id":655895,"name":"Bartuğ Elmaz","shirtNumber":"28","positionId":3,"link":"/bartug-elmaz/profil/spieler/655895"},{"id":322873,"name":"İrfan Can Eğribayat","shirtNumber":"30","positionId":1,"link":"/irfan-can-egribayat/profil/spieler/322873"},{"id":306462,"name":"Mert Hakan Yandaş","shirtNumber":"8","positionId":3,"link":"/mert-hakan-yandas/profil/spieler/306462"},{"id":654049,"name":"Ertuğrul Çetin","shirtNumber":"54","positionId":1,"link":"/ertugrul-cetin/profil/spieler/654049"},{"id":44996,"name":"Serdar Aziz","shirtNumber":"0","positionId":2,"link":"/serdar-aziz/profil/spieler/44996"},{"id":340251,"name":"Burak Kapacak","shirtNumber":"0","positionId":4,"link":"/burak-kapacak/profil/spieler/340251"}],
    "Galatasaray": [{"id":401923,"name":"Victor Osimhen","shirtNumber":"45","positionId":4,"link":"/victor-osimhen/profil/spieler/401923"},{"id":541537,"name":"Barış Alper Yılmaz","shirtNumber":"53","positionId":4,"link":"/baris-alper-yilmaz/profil/spieler/541537"},{"id":553469,"name":"Gabriel Sara","shirtNumber":"20","positionId":3,"link":"/gabriel-sara/profil/spieler/553469"},{"id":341429,"name":"Davinson Sánchez","shirtNumber":"6","positionId":2,"link":"/davinson-sanchez/profil/spieler/341429"},{"id":422951,"name":"Victor Nelsson","shirtNumber":"25","positionId":2,"link":"/victor-nelsson/profil/spieler/422951"},{"id":68863,"name":"Mauro Icardi","shirtNumber":"9","positionId":4,"link":"/mauro-icardi/profil/spieler/68863"},{"id":318077,"name":"Lucas Torreira","shirtNumber":"34","positionId":3,"link":"/lucas-torreira/profil/spieler/318077"},{"id":332798,"name":"Roland Sallai","shirtNumber":"7","positionId":4,"link":"/roland-sallai/profil/spieler/332798"},{"id":179184,"name":"Michy Batshuayi","shirtNumber":"44","positionId":4,"link":"/michy-batshuayi/profil/spieler/179184"},{"id":375137,"name":"Ismail Jakobs","shirtNumber":"4","positionId":2,"link":"/ismail-jakobs/profil/spieler/375137"},{"id":646478,"name":"Elias Jelert","shirtNumber":"24","positionId":2,"link":"/elias-jelert/profil/spieler/646478"},{"id":199316,"name":"Abdülkerim Bardakcı","shirtNumber":"42","positionId":2,"link":"/abdulkerim-bardakci/profil/spieler/199316"},{"id":217111,"name":"Hakim Ziyech","shirtNumber":"22","positionId":4,"link":"/hakim-ziyech/profil/spieler/217111"},{"id":396908,"name":"Yunus Akgün","shirtNumber":"11","positionId":4,"link":"/yunus-akgun/profil/spieler/396908"},{"id":119031,"name":"Kaan Ayhan","shirtNumber":"23","positionId":2,"link":"/kaan-ayhan/profil/spieler/119031"},{"id":125858,"name":"Kerem Demirbay","shirtNumber":"8","positionId":3,"link":"/kerem-demirbay/profil/spieler/125858"},{"id":469787,"name":"Berkan Kutlu","shirtNumber":"18","positionId":3,"link":"/berkan-kutlu/profil/spieler/469787"},{"id":548031,"name":"Yusuf Demir","shirtNumber":"30","positionId":4,"link":"/yusuf-demir/profil/spieler/548031"},{"id":56416,"name":"Dries Mertens","shirtNumber":"10","positionId":4,"link":"/dries-mertens/profil/spieler/56416"},{"id":618869,"name":"Metehan Baltacı","shirtNumber":"90","positionId":2,"link":"/metehan-baltaci/profil/spieler/618869"},{"id":58088,"name":"Fernando Muslera","shirtNumber":"1","positionId":1,"link":"/fernando-muslera/profil/spieler/58088"},{"id":605110,"name":"Eyüp Aydın","shirtNumber":"5","positionId":3,"link":"/eyup-aydin/profil/spieler/605110"},{"id":1016253,"name":"Efe Akman","shirtNumber":"83","positionId":3,"link":"/efe-akman/profil/spieler/1016253"},{"id":114422,"name":"Günay Güvenç","shirtNumber":"19","positionId":1,"link":"/gunay-guvenc/profil/spieler/114422"},{"id":352659,"name":"Batuhan Şen","shirtNumber":"12","positionId":1,"link":"/batuhan-sen/profil/spieler/352659"},{"id":884821,"name":"Gökdeniz Gürpüz","shirtNumber":"33","positionId":3,"link":"/gokdeniz-gurpuz/profil/spieler/884821"},{"id":942939,"name":"Ali Yeşilyurt","shirtNumber":"58","positionId":2,"link":"/ali-yesilyurt/profil/spieler/942939"},{"id":873532,"name":"Atakan Ordu","shirtNumber":"38","positionId":1,"link":"/atakan-ordu/profil/spieler/873532"}],
    "Real Madrid": [{"id":371998,"name":"Vinicius Junior","shirtNumber":"7","positionId":4,"link":"/vinicius-junior/profil/spieler/371998"},{"id":342229,"name":"Kylian Mbappé","shirtNumber":"9","positionId":4,"link":"/kylian-mbappe/profil/spieler/342229"},{"id":581678,"name":"Jude Bellingham","shirtNumber":"5","positionId":3,"link":"/jude-bellingham/profil/spieler/581678"},{"id":369081,"name":"Federico Valverde","shirtNumber":"8","positionId":3,"link":"/federico-valverde/profil/spieler/369081"},{"id":412363,"name":"Rodrygo","shirtNumber":"11","positionId":4,"link":"/rodrygo/profil/spieler/412363"},{"id":413112,"name":"Aurélien Tchouaméni","shirtNumber":"14","positionId":3,"link":"/aurelien-tchouameni/profil/spieler/413112"},{"id":640428,"name":"Eduardo Camavinga","shirtNumber":"6","positionId":3,"link":"/eduardo-camavinga/profil/spieler/640428"},{"id":401530,"name":"Éder Militão","shirtNumber":"3","positionId":2,"link":"/eder-militao/profil/spieler/401530"},{"id":971570,"name":"Endrick","shirtNumber":"16","positionId":4,"link":"/endrick/profil/spieler/971570"},{"id":861410,"name":"Arda Güler","shirtNumber":"15","positionId":4,"link":"/arda-guler/profil/spieler/861410"},{"id":314678,"name":"Brahim Díaz","shirtNumber":"21","positionId":4,"link":"/brahim-diaz/profil/spieler/314678"},{"id":86202,"name":"Antonio Rüdiger","shirtNumber":"22","positionId":2,"link":"/antonio-rudiger/profil/spieler/86202"},{"id":108390,"name":"Thibaut Courtois","shirtNumber":"1","positionId":1,"link":"/thibaut-courtois/profil/spieler/108390"},{"id":404839,"name":"Andriy Lunin","shirtNumber":"13","positionId":1,"link":"/andriy-lunin/profil/spieler/404839"},{"id":291417,"name":"Ferland Mendy","shirtNumber":"23","positionId":2,"link":"/ferland-mendy/profil/spieler/291417"},{"id":59016,"name":"David Alaba","shirtNumber":"4","positionId":2,"link":"/david-alaba/profil/spieler/59016"},{"id":341264,"name":"Fran García","shirtNumber":"20","positionId":2,"link":"/fran-garcia/profil/spieler/341264"},{"id":138927,"name":"Daniel Carvajal","shirtNumber":"2","positionId":2,"link":"/daniel-carvajal/profil/spieler/138927"},{"id":27992,"name":"Luka Modric","shirtNumber":"10","positionId":3,"link":"/luka-modric/profil/spieler/27992"},{"id":221316,"name":"Lucas Vázquez","shirtNumber":"17","positionId":2,"link":"/lucas-vazquez/profil/spieler/221316"},{"id":319745,"name":"Dani Ceballos","shirtNumber":"19","positionId":3,"link":"/dani-ceballos/profil/spieler/319745"},{"id":251896,"name":"Jesús Vallejo","shirtNumber":"18","positionId":2,"link":"/jesus-vallejo/profil/spieler/251896"},{"id":935245,"name":"Raúl Asencio","shirtNumber":"35","positionId":2,"link":"/raul-asencio/profil/spieler/935245"}],
    "Manchester City": [{"id":418560,"name":"Erling Haaland","shirtNumber":"9","positionId":4,"link":"/erling-haaland/profil/spieler/418560"},{"id":406635,"name":"Phil Foden","shirtNumber":"47","positionId":4,"link":"/phil-foden/profil/spieler/406635"},{"id":357565,"name":"Rodri","shirtNumber":"16","positionId":3,"link":"/rodri/profil/spieler/357565"},{"id":258004,"name":"Rúben Dias","shirtNumber":"3","positionId":2,"link":"/ruben-dias/profil/spieler/258004"},{"id":475959,"name":"Josko Gvardiol","shirtNumber":"24","positionId":2,"link":"/josko-gvardiol/profil/spieler/475959"},{"id":241641,"name":"Bernardo Silva","shirtNumber":"20","positionId":3,"link":"/bernardo-silva/profil/spieler/241641"},{"id":486049,"name":"Jérémy Doku","shirtNumber":"11","positionId":4,"link":"/jeremy-doku/profil/spieler/486049"},{"id":203460,"name":"Jack Grealish","shirtNumber":"10","positionId":4,"link":"/jack-grealish/profil/spieler/203460"},{"id":743591,"name":"Savinho","shirtNumber":"26","positionId":4,"link":"/savinho/profil/spieler/743591"},{"id":284730,"name":"Manuel Akanji","shirtNumber":"25","positionId":2,"link":"/manuel-akanji/profil/spieler/284730"},{"id":88755,"name":"Kevin De Bruyne","shirtNumber":"17","positionId":3,"link":"/kevin-de-bruyne/profil/spieler/88755"},{"id":177476,"name":"Nathan Aké","shirtNumber":"6","positionId":2,"link":"/nathan-ake/profil/spieler/177476"},{"id":601883,"name":"Matheus Nunes","shirtNumber":"27","positionId":3,"link":"/matheus-nunes/profil/spieler/601883"},{"id":701057,"name":"Rico Lewis","shirtNumber":"82","positionId":2,"link":"/rico-lewis/profil/spieler/701057"},{"id":186590,"name":"John Stones","shirtNumber":"5","positionId":2,"link":"/john-stones/profil/spieler/186590"},{"id":238223,"name":"Ederson","shirtNumber":"31","positionId":1,"link":"/ederson/profil/spieler/238223"},{"id":51471,"name":"Mateo Kovacic","shirtNumber":"8","positionId":3,"link":"/mateo-kovacic/profil/spieler/51471"},{"id":661207,"name":"Oscar Bobb","shirtNumber":"52","positionId":4,"link":"/oscar-bobb/profil/spieler/661207"},{"id":95424,"name":"Kyle Walker","shirtNumber":"2","positionId":2,"link":"/kyle-walker/profil/spieler/95424"},{"id":53622,"name":"İlkay Gündoğan","shirtNumber":"19","positionId":3,"link":"/ilkay-gundogan/profil/spieler/53622"},{"id":583199,"name":"James McAtee","shirtNumber":"87","positionId":3,"link":"/james-mcatee/profil/spieler/583199"},{"id":85941,"name":"Stefan Ortega","shirtNumber":"18","positionId":1,"link":"/stefan-ortega/profil/spieler/85941"},{"id":576121,"name":"Josh Wilson-Esbrand","shirtNumber":"97","positionId":2,"link":"/josh-wilson-esbrand/profil/spieler/576121"},{"id":14555,"name":"Scott Carson","shirtNumber":"33","positionId":1,"link":"/scott-carson/profil/spieler/14555"}]
}

# Add players for each team
for team_name, players in teams_and_players.items():
    add_players_from_list(players, team_name)
